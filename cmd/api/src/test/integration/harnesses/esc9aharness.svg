<!--
Copyright 2024 Specter Ops, Inc.

Licensed under the Apache License, Version 2.0
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

SPDX-License-Identifier: Apache-2.0
-->
<svg xmlns="http://www.w3.org/2000/svg" width="2090" height="796" viewBox="0 0 2090 796"><defs><style type="text/css"/></defs><g transform="translate(-75 79.2) scale(1)"><g class="relationship"><g transform="translate(748.6949982406376 182.23146280877245) rotate(0)" stroke-width="5" stroke="#a4dd00"><path d="M 59 0 L 260.1881643270193 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#a4dd00" transform="translate(285.0503149447676 0) rotate(0)" stroke="none"/></g><g transform="translate(908.2890804041472 182.23146280877245) rotate(0) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-50.766666412353516 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="101.53333282470703" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">PublishedTo</text></g></g></g></g><g class="relationship"><g transform="translate(1596.163360694819 350.35614824592676) rotate(32.35901172471561)" stroke-width="5" stroke="#a4dd00"><path d="M 59 0 L 459.37207870231407 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#a4dd00" transform="translate(484.23422932006235 0) rotate(0)" stroke="none"/></g><g transform="translate(1815.100666796973 489.0783850764769) rotate(32.35901172471561) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-45.00833511352539 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="90.01667022705078" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">RootCAFor</text></g></g></g></g><g class="relationship"><g transform="translate(748.6949982406376 436.7832960176713) rotate(-36.49655545450417)" stroke-width="5" stroke="#a4dd00"><path d="M 59 0 L 344.11828702351215 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#a4dd00" transform="translate(368.98043764126044 0) rotate(0)" stroke="none"/></g><g transform="translate(910.7269060245735 316.90106550334224) rotate(-36.49655545450417) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-26.508333206176758 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="53.016666412353516" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">Enroll</text></g></g></g></g><g class="relationship"><g transform="translate(748.6949982406376 436.7832960176713) rotate(-90)" stroke-width="5" stroke="#a4dd00"><path d="M 59 0 L 170.68968259115059 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#a4dd00" transform="translate(195.55183320889887 0) rotate(0)" stroke="none"/></g><g transform="translate(748.6949982406376 321.938454722096) rotate(90) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-26.508333206176758 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="53.016666412353516" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">Enroll</text></g></g></g></g><g class="relationship"><g transform="translate(1092.7453131854052 182.23146280877245) rotate(18.46758463951968)" stroke-width="5" stroke="#7b64ff"><path d="M 59 0 L 446.88792277982793 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#7b64ff" transform="translate(471.7500733975762 0) rotate(0)" stroke="none"/></g><g transform="translate(1332.6634244671748 262.356037582126) rotate(18.46758463951968) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-64.76666641235352 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="129.53333282470703" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">IssuedSignedBy</text></g></g></g></g><g class="relationship"><g transform="translate(1596.163360694819 182.23146280877245) rotate(45)" stroke-width="5" stroke="#a4dd00"><path d="M 59 0 L 565.0864343121065 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#a4dd00" transform="translate(589.9485849298547 0) rotate(0)" stroke="none"/></g><g transform="translate(1816.8112355691305 402.8793376830841) rotate(45) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-64.92499923706055 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="129.8499984741211" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">NTAuthStoreFor</text></g></g></g></g><g class="relationship"><g transform="translate(1092.7453131854052 182.23146280877245) rotate(0)" stroke-width="5" stroke="#7b64ff"><path d="M 59 0 L 419.5558968916655 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#7b64ff" transform="translate(444.4180475094138 0) rotate(0)" stroke="none"/></g><g transform="translate(1332.0232616312378 182.23146280877245) rotate(0) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-73.59166717529297 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="147.18333435058594" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">TrustedForNTAuth</text></g></g></g></g><g class="relationship"><g transform="translate(472.5320881490078 641.1074078540869) rotate(-36.496555454504175)" stroke-width="5" stroke="#000000"><path d="M 59 0 L 259.6699375312595 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#000000" transform="translate(284.5320881490078 0) rotate(0)" stroke="none"/></g><g transform="translate(600.6202935063749 546.3390380259995) rotate(-36.496555454504175) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-54.11666488647461 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="108.23332977294922" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">GenericWrite</text></g></g></g></g><g class="relationship"><g transform="translate(472.5320881490078 641.1074078540869) rotate(0)" stroke-width="5" stroke="#7b64ff"><path d="M 59 0 L 1498.6450669733772 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#7b64ff" transform="translate(1523.5072175911255 0) rotate(0)" stroke="none"/></g><g transform="translate(1251.3546216356963 641.1074078540869) rotate(0) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-48.36666488647461 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="96.73332977294922" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">ADCSESC9a</text></g></g></g></g><g class="relationship"><g transform="translate(472.5320881490078 641.1074078540869) rotate(180)" stroke-width="5" stroke="#ffffff"><path d="M 59 0 L 259.6699375312595 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#ffffff" transform="translate(284.5320881490078 0) rotate(0)" stroke="none"/></g></g><g class="relationship"><g transform="translate(1596.163360694819 -4) rotate(54.57510611153964)" stroke-width="5" stroke="#a4dd00"><path d="M 59 0 L 707.8010988825994 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#a4dd00" transform="translate(732.6632495003477 0) rotate(0)" stroke="none"/></g><g transform="translate(1818.3958434667654 308.4239185992439) rotate(54.57510611153964) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-28.191667556762695 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="56.38333511352539" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">DCFor</text></g></g></g></g><g class="relationship"><g transform="translate(1092.7453131854052 182.23146280877245) rotate(-20.301148552960658)" stroke-width="5" stroke="#7b64ff"><path d="M 59 0 L 452.8983996261063 0"/><polygon points="-24.8621506177483,0 -27.62461179749811,9.20820393249937 0,0 -27.62461179749811,-9.20820393249937" fill="#7b64ff" transform="translate(477.7605502438546 0) rotate(0)" stroke="none"/></g><g transform="translate(1332.7954554191194 93.42874833159128) rotate(-20.301148552960658) translate(0 -13)"><g transform="translate(0 0)"><g transform="translate(-108.16666412353516 0)" fill="#ffffff" stroke="#000000" stroke-width="0"><rect x="0" y="0" width="216.3333282470703" height="26" rx="5" ry="5" stroke="none"/><text xml:space="preserve" x="5" y="17.5" stroke="none" text-anchor="left" font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000">CanAbuseWeakCertBinding</text></g></g></g></g><g class="node"><g fill="#68ccca" stroke="#000000" stroke-width="4"><circle cx="2055.0393057401334" cy="641.1074078540869" r="52"/></g><g transform="translate(2055.0393057401334 641.1074078540869)"><g transform="scale(0.46093803906249997) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#000000" text-anchor="middle"><text xml:space="preserve" x="0" y="14.5" stroke="none">Domain</text></g></g></g><g transform="translate(39.59797974644666 39.597979746446654)"><g transform="translate(0 0)"><g transform="translate(0 0)" fill="white"><rect x="0" y="0" width="69.46666431427002" height="19.2" rx="0" ry="0" stroke="none"/><g font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000" text-anchor="end"><text xml:space="preserve" x="51.29999828338623" y="14.1" stroke="none">name:</text><text xml:space="preserve" x="55.46666479110718" y="14.1" stroke="none" text-anchor="start">d</text></g></g></g></g></g></g><g class="node"><g fill="#653294" stroke="#000000" stroke-width="4"><circle cx="1596.163360694819" cy="182.23146280877245" r="52"/></g><g transform="translate(1596.163360694819 182.23146280877245)"><g transform="scale(0.294922580078125) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#ffffff" text-anchor="middle"><text xml:space="preserve" x="0" y="14.5" stroke="none">NTAuthStore</text></g></g></g></g></g><g class="node"><g fill="#653294" stroke="#000000" stroke-width="4"><circle cx="1596.163360694819" cy="350.35614824592676" r="52"/></g><g transform="translate(1596.163360694819 350.35614824592676)"><g transform="scale(0.48828176171874993) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#ffffff" text-anchor="middle"><text xml:space="preserve" x="0" y="14.5" stroke="none">RootCA</text></g></g></g></g></g><g class="node"><g fill="#194d33" stroke="#000000" stroke-width="4"><circle cx="1092.7453131854052" cy="182.23146280877245" r="52"/></g><g transform="translate(1092.7453131854052 182.23146280877245)"><g transform="scale(0.287110087890625) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#ffffff" text-anchor="middle"><text xml:space="preserve" x="0" y="14.5" stroke="none">EnterpriseCA</text></g></g></g><g transform="translate(3.429011037612589e-15 -75.2)"><g transform="translate(0 0)"><g transform="translate(-42.658331871032715 0)" fill="white"><rect x="0" y="0" width="85.31666374206543" height="19.2" rx="0" ry="0" stroke="none"/><g font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000" text-anchor="end"><text xml:space="preserve" x="51.29999828338623" y="14.1" stroke="none">name:</text><text xml:space="preserve" x="55.46666479110718" y="14.1" stroke="none" text-anchor="start">eca</text></g></g></g></g></g></g><g class="node"><g fill="#fda1ff" stroke="#000000" stroke-width="4"><circle cx="748.6949982406376" cy="182.23146280877245" r="52"/></g><g transform="translate(748.6949982406376 182.23146280877245)"><g transform="scale(0.27929759570312496) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#000000" text-anchor="middle"><text xml:space="preserve" x="0" y="14.5" stroke="none">CertTemplate</text></g></g></g><g transform="translate(-39.597979746446654 -193.19797974644666)"><g transform="translate(0 0)"><g transform="translate(-266.93333435058594 0)" fill="white"><rect x="0" y="0" width="266.93333435058594" height="153.6" rx="0" ry="0" stroke="none"/><g font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000" text-anchor="end"><text xml:space="preserve" x="220.50000286102295" y="14.1" stroke="none">name:</text><text xml:space="preserve" x="224.6666693687439" y="14.1" stroke="none" text-anchor="start">ct</text><text xml:space="preserve" x="220.50000286102295" y="33.3" stroke="none" text-anchor="end">AuthenticationEnabled:</text><text xml:space="preserve" x="224.6666693687439" y="33.3" stroke="none" text-anchor="start">True</text><text xml:space="preserve" x="220.50000286102295" y="52.5" stroke="none" text-anchor="end">RequiresManagerApproval:</text><text xml:space="preserve" x="224.6666693687439" y="52.5" stroke="none" text-anchor="start">False</text><text xml:space="preserve" x="220.50000286102295" y="71.7" stroke="none" text-anchor="end">NoSecurityExtension:</text><text xml:space="preserve" x="224.6666693687439" y="71.7" stroke="none" text-anchor="start">True</text><text xml:space="preserve" x="220.50000286102295" y="90.89999999999999" stroke="none" text-anchor="end">SubjectAltNameRequireUPN:</text><text xml:space="preserve" x="224.6666693687439" y="90.89999999999999" stroke="none" text-anchor="start">True</text><text xml:space="preserve" x="220.50000286102295" y="110.1" stroke="none" text-anchor="end">SchemaVersion:</text><text xml:space="preserve" x="224.6666693687439" y="110.1" stroke="none" text-anchor="start">1</text><text xml:space="preserve" x="220.50000286102295" y="129.3" stroke="none" text-anchor="end">EnrolleeSuppliesSubject:</text><text xml:space="preserve" x="224.6666693687439" y="129.3" stroke="none" text-anchor="start">False</text><text xml:space="preserve" x="220.50000286102295" y="148.5" stroke="none" text-anchor="end">SubjectAltRequireSPN:</text><text xml:space="preserve" x="224.6666693687439" y="148.5" stroke="none" text-anchor="start">True</text></g></g></g></g></g></g><g class="node"><g fill="#ffffff" stroke="#000000" stroke-width="4"><circle cx="748.6949982406376" cy="436.7832960176713" r="52"/></g><g transform="translate(748.6949982406376 436.7832960176713)"><g transform="scale(0.359375640625) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#000000" text-anchor="middle"><text xml:space="preserve" x="0" y="-75.5" stroke="none">AD</text><text xml:space="preserve" x="0" y="-15.5" stroke="none" text-anchor="middle">principal</text><text xml:space="preserve" x="0" y="44.5" stroke="none" text-anchor="middle">(Victim)</text></g></g></g><g transform="translate(39.59797974644666 39.597979746446654)"><g transform="translate(0 0)"><g transform="translate(0 0)" fill="white"><rect x="0" y="0" width="77.5999984741211" height="19.2" rx="0" ry="0" stroke="none"/><g font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000" text-anchor="end"><text xml:space="preserve" x="51.29999828338623" y="14.1" stroke="none">name:</text><text xml:space="preserve" x="55.46666479110718" y="14.1" stroke="none" text-anchor="start">vp</text></g></g></g></g></g></g><g class="node"><g fill="#ffffff" stroke="#000000" stroke-width="4"><circle cx="472.5320881490078" cy="641.1074078540869" r="52"/></g><g transform="translate(472.5320881490078 641.1074078540869)"><g transform="scale(0.35546939453125004) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#000000" text-anchor="middle"><text xml:space="preserve" x="0" y="-75.5" stroke="none">AD</text><text xml:space="preserve" x="0" y="-15.5" stroke="none" text-anchor="middle">principal</text><text xml:space="preserve" x="0" y="44.5" stroke="none" text-anchor="middle">(attacker)</text></g></g></g><g transform="translate(3.429011037612589e-15 56)"><g transform="translate(0 0)"><g transform="translate(-39.22499942779541 0)" fill="white"><rect x="0" y="0" width="78.44999885559082" height="19.2" rx="0" ry="0" stroke="none"/><g font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000" text-anchor="end"><text xml:space="preserve" x="51.29999828338623" y="14.1" stroke="none">name:</text><text xml:space="preserve" x="55.46666479110718" y="14.1" stroke="none" text-anchor="start">ap</text></g></g></g></g></g></g><g class="node"><g fill="#ffffff" stroke="#ffffff" stroke-width="4"><circle cx="129" cy="641.1074078540869" r="52"/></g></g><g class="node"><g fill="#f44e3b" stroke="#000000" stroke-width="4"><circle cx="1596.163360694819" cy="-4" r="52"/></g><g transform="translate(1596.163360694819 -4)"><g transform="scale(0.984375015625) translate(0 0)"><g transform="translate(0 0)"><g font-family="sans-serif" font-size="50" font-weight="normal" fill="#000000" text-anchor="middle"><text xml:space="preserve" x="0" y="14.5" stroke="none">DC</text></g></g></g><g transform="translate(3.429011037612589e-15 -75.2)"><g transform="translate(0 0)"><g transform="translate(-38.57499885559082 0)" fill="white"><rect x="0" y="0" width="77.14999771118164" height="19.2" rx="0" ry="0" stroke="none"/><g font-family="sans-serif" font-size="16" font-weight="normal" fill="#000000" text-anchor="end"><text xml:space="preserve" x="51.29999828338623" y="14.1" stroke="none">name:</text><text xml:space="preserve" x="55.46666479110718" y="14.1" stroke="none" text-anchor="start">dc</text></g></g></g></g></g></g></g></svg>
