# Copyright 2026 Specter Ops, Inc.
#
# Licensed under the Apache License, Version 2.0
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# SPDX-License-Identifier: Apache-2.0

type: object
properties:
  extension:
    type: object
    properties:
      name:
        type: string
        example: Active_Directory
      display_name:
        type: string
        example: Azure
      version:
        type: string
        example: "1.0.0"
      namespace:
        type: string
        example: "AD"
  node_kinds:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
          example: Computer
        display_name:
          type: string
          example: Computer
        description:
          type: string
          example: Active Directory Computer object
        is_display_kind:
          type: boolean
        icon:
          type: string
          example: Desktop
        icon_color:
          type: string
          example: "#FF0000"
  relationship_kinds:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
          example: MemberOf
        description:
          type: string
          example: Active Directory MemberOf edge
        is_traversable:
          type: boolean
  properties:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
          example: UserPrincipalName
        display_name:
          type: string
          example: User Principal Name
        data_type:
          type: string
          example: string
        description:
          type: string
          example: An Active Directory User Principal Name
  environments:
    type: array
    items:
      type: object
      properties:
        environment_kind:
          type: string
          example: Domain
        source_kind:
          type: string
          example: Base
        principal_kinds:
          type: array
          items:
            type: string
            example:
              - User
              - Computer
              - Group
  relationship_findings:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
          example: malicious_finding_1
        display_name:
          type: string
          example: Malicious Finding 1
        source_kind:
          type: string
          example: Base
        relationship_kind:
          type: string
          example: MemberOf
        environment_kind:
          type: string
          example: Domain
        remediation:
          type: object
          properties:
            short_description:
              type: string
            long_description:
              type: string
            short_remediation:
              type: string
            long_remediation:
              type:  string
